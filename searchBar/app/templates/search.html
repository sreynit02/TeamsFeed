{%extends 'base.html' %}
{% block main %}
    <div id="piechart" style="width: 900px; height: 500px;"></div>
    </div>
        <table class="table table-hover">
            <thead>
              <tr>
                <th scope="col">County</th>
                <th scope="col">Number of farmers</th>
              </tr>
            </thead>
            <tbody>
                {% for searchResult in searchResults %}
              <tr>
                <td>{{searchResult[0]}}</td>
                <td>{{searchResult[1]}}</td>
              </tr>
              {% endfor %}
            </tbody>
        </table>
        <script type="text/javascript">
          google.charts.load('current', {'packages':['corechart']});
          google.charts.setOnLoadCallback(drawChart);
        
          function drawChart() {
            let results={{ countyList | safe }}
          
            //console.log(typeof(results),results)
            resultsList=[]
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'County');
            data.addColumn('number', 'Number of farmers in county');
            for (let i=0;i<results.length;i++){
              tempArray=[]
              tempArray.push(results[i][0])
              tempArray.push(results[i][1])
              // create an Array to make sure everything is an array
              data.addRow(Array.from(tempArray))
            }
    
            var options = {
              title: 'Number of Farmers from each county'
            };
      
            var chart = new google.visualization.PieChart(document.getElementById('piechart'));
            chart.draw(data, options);
          }
        </script>
{%endblock%}